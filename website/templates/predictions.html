<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>F1 2025 Season Predictions - DriveAhead Analytics</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/predictions.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        /* Additional error state styles */
        .error-state {
            text-align: center;
            padding: var(--spacing-xl);
            color: var(--text-secondary);
        }
        
        .error-icon {
            font-size: 3rem;
            color: var(--warning-color);
            margin-bottom: var(--spacing-md);
        }
        
        .error-state h3 {
            color: var(--text-primary);
            margin-bottom: var(--spacing-sm);
        }
        
        .error-state p {
            margin-bottom: var(--spacing-lg);
        }
        
        .retry-btn {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: var(--spacing-sm) var(--spacing-lg);
            border-radius: var(--border-radius);
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
        }
        
        .retry-btn:hover {
            background: var(--primary-hover);
            transform: translateY(-2px);
        }
        
        .retry-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .no-data {
            text-align: center;
            padding: var(--spacing-xl);
            color: var(--text-secondary);
        }
        
        .no-data i {
            font-size: 3rem;
            color: var(--text-muted);
            margin-bottom: var(--spacing-md);
        }
        
        .global-error {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--bg-card);
            border: 1px solid var(--warning-color);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            z-index: 1000;
            max-width: 400px;
            box-shadow: var(--shadow-lg);
        }
        
        .error-content {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }
        
        .error-content button {
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            margin-left: auto;
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <img src="{{ url_for('static', filename='images/logo.png') }}" alt="DriveAhead Logo" class="logo-image">
                <div class="text-container">
                    <h1>DriveAhead</h1>
                    <span class="tagline">F1 Race Predictions</span>
                </div>
            </div>
            <ul class="nav-menu">
                <li><a href="/">Home</a></li>
                <li><a href="/predictions" class="active">Live Predictions</a></li>
                <li><a href="/telemetry">Live Telemetry</a></li>
            </ul>
            <div class="hamburger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </nav>

    <main class="predictions-main">
        <!-- Hero Section -->
        <section class="predictions-hero">
            <div class="container">
                <div class="hero-content">
                    <h1>Live F1 Race Predictions</h1>
                    <p class="hero-subtitle">AI-powered race winner predictions with real-time updates and comprehensive analysis</p>
                    <div class="prediction-stats">
                        <div class="stat">
                            <span class="stat-number" id="remainingRaces">--</span>
                            <span class="stat-label">Remaining Races</span>
                        </div>
                        <div class="stat">
                            <span class="stat-number" id="modelAccuracy">--.-%</span>
                            <span class="stat-label">Model Accuracy</span>
                        </div>
                        <div class="stat">
                            <span class="stat-number" id="totalTeams">--</span>
                            <span class="stat-label">F1 Teams</span>
                        </div>
                        <div class="stat">
                            <span class="stat-number" id="totalDrivers">--</span>
                            <span class="stat-label">Drivers</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Race Header with Model Accuracy (matches screenshot design) -->
        <section class="race-header-section">
            <div class="container">
                <div class="race-header-container">
                    <!-- Race Information -->
                    <div class="race-info">
                        <h1 class="race-title" id="raceTitle">Loading...</h1>
                        <div class="race-details">
                            <span class="race-date" id="raceDate">Loading...</span>
                            <span class="race-status" id="raceStatus">LIVE PREDICTIONS</span>
                            <span class="race-weather" id="raceWeather">Loading...</span>
                        </div>
                    </div>
                    
                    <!-- Model Accuracy Display -->
                    <div class="model-accuracy">
                        <h3>Model Accuracy</h3>
                        <div class="accuracy-metrics">
                            <div class="accuracy-item">
                                <span class="accuracy-percentage" id="winnerAccuracy">--.--%</span>
                                <span class="accuracy-label">Race Winner</span>
                            </div>
                            <div class="accuracy-item">
                                <span class="accuracy-percentage" id="podiumAccuracy">--.--%</span>
                                <span class="accuracy-label">Podium</span>
                            </div>
                            <div class="accuracy-item">
                                <span class="accuracy-percentage" id="top10Accuracy">--.--%</span>
                                <span class="accuracy-label">Top 10</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- All Upcoming Races Grid -->
        <section class="all-races-section">
            <div class="container">
                <h2 class="section-title">
                    <i class="fas fa-trophy"></i>
                    All Upcoming Race Predictions
                </h2>
                <div class="races-grid" id="allRacePredictions">
                    <!-- Populated by JavaScript -->
                </div>
            </div>
        </section>

        <!-- Teams & Performance Analytics -->
        <section class="teams-performance-section">
            <div class="container">
                <div class="analytics-grid">
                    <!-- Teams Grid -->
                    <div class="teams-container">
                        <h2 class="section-title">
                            <i class="fas fa-users"></i>
                            2025 F1 Teams & Drivers
                        </h2>
                        <div class="teams-grid" id="teamsGrid">
                            <!-- Populated by JavaScript -->
                        </div>
                    </div>

                    <!-- Model Performance -->
                    <div class="performance-container">
                        <h2 class="section-title">
                            <i class="fas fa-chart-line"></i>
                            AI Model Performance
                        </h2>
                        <div class="performance-cards">
                            <div class="performance-card">
                                <div class="performance-icon">
                                    <i class="fas fa-bullseye"></i>
                                </div>
                                <div class="performance-content">
                                    <h3>Overall Accuracy</h3>
                                    <div class="accuracy-meter">
                                        <div class="meter-bar">
                                            <div class="meter-fill" id="overall-accuracy-bar" data-width="0"></div>
                                        </div>
                                        <span class="accuracy-percentage" id="overall-accuracy">--.-%</span>
                                    </div>
                                    <p>Across all race predictions in 2024-2025</p>
                                </div>
                            </div>
                            
                            <div class="performance-card">
                                <div class="performance-icon">
                                    <i class="fas fa-road"></i>
                                </div>
                                <div class="performance-content">
                                    <h3>Street Circuit Accuracy</h3>
                                    <div class="accuracy-meter">
                                        <div class="meter-bar">
                                            <div class="meter-fill" id="street-circuit-bar" data-width="0"></div>
                                        </div>
                                        <span class="accuracy-percentage" id="street-circuit-accuracy">--.-%</span>
                                    </div>
                                    <p>Specialized for circuits like Monaco & Singapore</p>
                                </div>
                            </div>
                            
                            <div class="performance-card">
                                <div class="performance-icon">
                                    <i class="fas fa-medal"></i>
                                </div>
                                <div class="performance-content">
                                    <h3>Podium Prediction</h3>
                                    <div class="accuracy-meter">
                                        <div class="meter-bar">
                                            <div class="meter-fill" id="podium-prediction-bar" data-width="0"></div>
                                        </div>
                                        <span class="accuracy-percentage" id="podium-prediction-accuracy">--.-%</span>
                                    </div>
                                    <p>Top 3 finishers prediction accuracy</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Live Predictions Dashboard -->
        <section class="predictions-dashboard-section">
            <div class="container">
                <div class="predictions-dashboard">
                    <!-- Race Winner Predictions -->
                    <section class="prediction-card winner-predictions">
                        <div class="card-header">
                            <h3><i class="fas fa-trophy"></i> Race Winner Predictions</h3>
                            <div class="update-indicator">
                                <span class="live-dot"></span>
                                <span class="update-time" id="winner-update">Updated 5s ago</span>
                            </div>
                        </div>
                        <div class="predictions-list" id="winner-predictions">
                            <!-- Dynamic content -->
                        </div>
                    </section>

                    <!-- Podium Predictions -->
                    <section class="prediction-card podium-predictions">
                        <div class="card-header">
                            <h3><i class="fas fa-medal"></i> Podium Finishers</h3>
                    <div class="confidence-level">
                        <span class="confidence-text">Confidence: </span>
                        <span class="confidence-value" id="podium-confidence">92.4%</span>
                    </div>
                </div>
                <div class="podium-container" id="podium-container">
                    <!-- Dynamic podium content -->
                </div>
            </section>

            <!-- Championship Impact -->
            <section class="prediction-card championship-impact">
                <div class="card-header">
                    <h3><i class="fas fa-crown"></i> Championship Impact</h3>
                    <div class="impact-toggle">
                        <button class="toggle-btn active" data-view="points">Points Impact</button>
                        <button class="toggle-btn" data-view="standings">Standings Impact</button>
                    </div>
                </div>
                <div class="impact-content">
                    <div class="championship-stats">
                        <div class="stat-box driver-gap">
                            <div class="stat-icon">
                                <i class="fas fa-trophy"></i>
                            </div>
                            <div class="stat-info">
                                <h4 id="championship-leader">Loading...</h4>
                                <p>Championship Leader</p>
                                <span class="points-lead" id="points-lead">-- points</span>
                            </div>
                        </div>
                        <div class="stat-box race-impact">
                            <div class="stat-icon">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <div class="stat-info">
                                <h4 id="race-impact-points">--</h4>
                                <p>Potential Points Gain</p>
                                <span class="impact-change" id="standings-change">-- positions</span>
                            </div>
                        </div>
                    </div>
                    <div class="championship-visualization">
                        <canvas id="championship-chart"></canvas>
                    </div>
                    <div class="title-probabilities" id="title-probabilities">
                        <!-- Dynamic title probability content -->
                    </div>
                </div>
            </section>

            <!-- Live Race Predictions Chart -->
            <section class="prediction-card race-predictions-chart">
                <div class="card-header">
                    <h3><i class="fas fa-chart-line"></i> Live Race Probability</h3>
                    <div class="chart-controls">
                        <select id="prediction-type">
                            <option value="winner">Race Winner</option>
                            <option value="podium">Podium Finish</option>
                            <option value="points">Points Finish</option>
                            <option value="fastest">Fastest Lap</option>
                        </select>
                        <div class="confidence-indicator">
                            <span class="confidence-label">Model Confidence:</span>
                            <span class="confidence-value" id="model-confidence">--%</span>
                        </div>
                    </div>
                </div>
                <div class="probability-overview">
                    <div class="prob-card favorite">
                        <div class="driver-info">
                            <span class="position">1st</span>
                            <span class="driver-name" id="p1-driver">Loading...</span>
                        </div>
                        <div class="probability" id="p1-probability">--%</div>
                    </div>
                    <div class="prob-card">
                        <div class="driver-info">
                            <span class="position">2nd</span>
                            <span class="driver-name" id="p2-driver">Loading...</span>
                        </div>
                        <div class="probability" id="p2-probability">--%</div>
                    </div>
                    <div class="prob-card">
                        <div class="driver-info">
                            <span class="position">3rd</span>
                            <span class="driver-name" id="p3-driver">Loading...</span>
                        </div>
                        <div class="probability" id="p3-probability">--%</div>
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="live-predictions-chart"></canvas>
                </div>
            </section>

            <!-- Key Factors -->
            <section class="prediction-card key-factors">
                <div class="card-header">
                    <h3><i class="fas fa-cogs"></i> Key Prediction Factors</h3>
                    <div class="factors-info">
                        <i class="fas fa-info-circle"></i>
                        <span>Real-time analysis</span>
                    </div>
                </div>
                <div class="factors-overview">
                    <div class="factor-summary">
                        <div class="summary-stat">
                            <span class="stat-label">Track Advantage</span>
                            <span class="stat-value" id="track-advantage">Loading...</span>
                        </div>
                        <div class="summary-stat">
                            <span class="stat-label">Weather Influence</span>
                            <span class="stat-value" id="weather-influence">Loading...</span>
                        </div>
                    </div>
                </div>
                <div class="factors-grid" id="factors-grid">
                    <div class="factor-item driver-form">
                        <div class="factor-header">
                            <i class="fas fa-user-check"></i>
                            <h4>Driver Form</h4>
                            <span class="factor-weight">25%</span>
                        </div>
                        <div class="factor-details">
                            <div class="form-indicator">
                                <span class="form-driver">Verstappen</span>
                                <div class="form-bar">
                                    <div class="form-fill" style="width: 92%"></div>
                                </div>
                                <span class="form-score">92%</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="factor-item track-data">
                        <div class="factor-header">
                            <i class="fas fa-road"></i>
                            <h4>Track Performance</h4>
                            <span class="factor-weight">20%</span>
                        </div>
                        <div class="factor-details">
                            <div class="track-stats">
                                <span class="track-stat">Lap Record: 1:20.827</span>
                                <span class="track-stat">DRS Zones: 3</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="factor-item car-performance">
                        <div class="factor-header">
                            <i class="fas fa-car"></i>
                            <h4>Car Setup</h4>
                            <span class="factor-weight">18%</span>
                        </div>
                        <div class="factor-details">
                            <div class="setup-info">
                                <span class="setup-item">Aerodynamics: High</span>
                                <span class="setup-item">Tire Strategy: Medium</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="factor-item strategy">
                        <div class="factor-header">
                            <i class="fas fa-chess"></i>
                            <h4>Race Strategy</h4>
                            <span class="factor-weight">15%</span>
                        </div>
                        <div class="factor-details">
                            <div class="strategy-info">
                                <span class="strategy-item">Pit Windows: 2</span>
                                <span class="strategy-item">Undercuts: High Risk</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Weather Impact -->
            <section class="prediction-card weather-impact">
                <div class="card-header">
                    <h3><i class="fas fa-cloud-sun"></i> Weather Impact Analysis</h3>
                    <div class="weather-status">
                        <span class="weather-risk low" id="weather-risk">Low Risk</span>
                        <span class="weather-temp" id="current-temp">24°C</span>
                    </div>
                </div>
                <div class="weather-overview">
                    <div class="weather-cards">
                        <div class="weather-card current">
                            <div class="weather-icon">
                                <i class="fas fa-sun" id="weather-icon"></i>
                            </div>
                            <div class="weather-info">
                                <span class="condition" id="weather-condition">Clear Sky</span>
                                <span class="details" id="weather-details-text">15% humidity, 5 km/h wind</span>
                            </div>
                        </div>
                        <div class="weather-card forecast">
                            <div class="forecast-icon">
                                <i class="fas fa-clock"></i>
                            </div>
                            <div class="forecast-info">
                                <span class="forecast-time">Race Start +2h</span>
                                <span class="forecast-change" id="forecast-change">No change expected</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="weather-details" id="weather-impact-details">
                    <div class="impact-factors">
                        <div class="impact-factor">
                            <div class="factor-header">
                                <i class="fas fa-thermometer-half"></i>
                                <span class="factor-name">Track Temperature</span>
                            </div>
                            <div class="factor-impact">
                                <span class="impact-level medium">Medium Impact</span>
                                <span class="impact-description">Affects tire degradation</span>
                            </div>
                        </div>
                        
                        <div class="impact-factor">
                            <div class="factor-header">
                                <i class="fas fa-wind"></i>
                                <span class="factor-name">Wind Speed</span>
                            </div>
                            <div class="factor-impact">
                                <span class="impact-level low">Low Impact</span>
                                <span class="impact-description">Minimal aerodynamic effect</span>
                            </div>
                        </div>
                        
                        <div class="impact-factor">
                            <div class="factor-header">
                                <i class="fas fa-tint"></i>
                                <span class="factor-name">Rain Probability</span>
                            </div>
                            <div class="factor-impact">
                                <span class="impact-level low">5% chance</span>
                                <span class="impact-description">Strategy unchanged</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="weather-recommendations">
                        <h4><i class="fas fa-lightbulb"></i> Strategy Recommendations</h4>
                        <ul class="recommendations-list">
                            <li>Optimal tire strategy: Hard-Medium-Soft</li>
                            <li>DRS effectiveness: Enhanced</li>
                            <li>Pit window: Laps 15-18, 35-40</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Fastest Lap Predictions -->
            <section class="prediction-card fastest-lap">
                <div class="card-header">
                    <h3><i class="fas fa-stopwatch"></i> Fastest Lap Prediction</h3>
                    <div class="lap-time-prediction">
                        <span class="predicted-time" id="predicted-lap-time">1:29.847</span>
                        <span class="lap-comparison" id="lap-comparison">-0.23s vs record</span>
                    </div>
                </div>
                <div class="lap-overview">
                    <div class="lap-stats">
                        <div class="lap-stat">
                            <i class="fas fa-trophy"></i>
                            <span class="stat-label">Current Record</span>
                            <span class="stat-value">1:20.827</span>
                            <span class="record-holder">Charles Leclerc (2023)</span>
                        </div>
                        <div class="lap-stat">
                            <i class="fas fa-chart-line"></i>
                            <span class="stat-label">Average Lap</span>
                            <span class="stat-value">1:23.145</span>
                            <span class="lap-context">Race pace estimate</span>
                        </div>
                    </div>
                </div>
                <div class="fastest-lap-candidates" id="fastest-lap-candidates">
                    <h4>Top Candidates</h4>
                    <div class="candidates-list" id="fastest-lap-candidates-list">
                        <!-- Populated by JavaScript from API -->
                    </div>
                    
                    <div class="lap-analysis">
                        <h5>Historical Analysis</h5>
                        <div class="analysis-points">
                            <div class="analysis-point">
                                <i class="fas fa-clock"></i>
                                <span>Best qualifying laps average 0.8s faster than fastest race laps</span>
                            </div>
                            <div class="analysis-point">
                                <i class="fas fa-tire"></i>
                                <span>Fresh soft tires provide 1.2-1.5s advantage for fastest lap attempts</span>
                            </div>
                            <div class="analysis-point">
                                <i class="fas fa-fuel-pump"></i>
                                <span>Low fuel load in final stint optimal for fastest lap attempts</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </div>
</section>

        <!-- Footer -->
        <footer class="predictions-footer">
            <div class="container">
                <div class="footer-content">
                    <div class="disclaimer">
                        <h4>Enterprise Analytics Disclaimer</h4>
                        <p>Predictions are based on advanced machine learning models analyzing driver performance, track conditions, weather data, and historical race outcomes. Past performance does not guarantee future results. For enterprise licensing and API access, contact our sales team.</p>
                    </div>
                    <div class="footer-links">
                        <a href="#api">API Documentation</a>
                        <a href="#enterprise">Enterprise Solutions</a>
                        <a href="#contact">Contact Sales</a>
                    </div>
                </div>
            </div>
        </footer>
    </div>

    <script src="{{ url_for('static', filename='js/predictions.js') }}"></script>
</body>
</html>